= Persistence Cache Benchmarks

Caveat emptor: non-scientific benchmarks.

Execute all tests by running `gradlew test`. Reports will be written to the root's `build/reports` directory.

== Assumptions

 * Data is read but not updated.
 * Collections are marked as lazy bit their contents are read immediately.
 * Default configuration for each caching solution.
 * No application server.
 * Single node, i.e, no distributed caches.

== Caching Providers

The following JPA compatible caching providers were selected

 * EclipseLink
 * Hibernate + Infinispan
 * Hibernate + Hazelcast
 * Hibernate + EhCache
 * Hibernate + Caffeine

The testcase runs for 50 iterations in order to warmup the JVM. The results look like this after the 50th iteration

[source]
----
                            Eclipselink  Infinispan   Hazelcast     EhCache    Caffeine
01 em1 [load L1C1; load L2C   13.497332   29.761332   24.369891   38.078855   92.809277
02 em2 [hit L2C; load L1C2]    4.771606    6.313264    4.157640    5.565752   21.008394
03 em2 [hit l1C2]              2.323158    2.200776    3.553077    2.585426    2.184439
04 em2 [hit L2C; load L1C2]    6.227024    6.111950    4.439370    5.670020   20.558323
05 em2 [load L1C2; load L2C   14.425914   31.792107   32.865633   33.439345   45.840621
06 em2 [hit l1C2]              2.332670    2.192553    2.404821    3.302681    2.905474
07 em3 [hit L2C; load L1C3]    5.230997   35.114809    4.375070    6.058060   21.395879
08 em3 [hit l1C3]              2.082420    2.397730    2.179949    2.747790    2.380451
09 em4 [hit L2C; load L1C4]    4.802970    6.020772    4.635258    6.546988   21.036647
10 em4 [hit l1C4]              2.987462    2.116523    2.348548    2.384092    2.735662
11 em5 [hit L2C; load L1C5]    5.334021    5.985727    4.302260    5.872530   20.195900
12 em5 [hit l1C5]              2.511636    2.086152    2.158952    2.938011    2.405727
13 em6 [hit L2C; load L1C6]    5.015225    6.082465    6.193973    5.853196   20.722064
14 em6 [hit l1C6]              3.406396    2.110163    2.673234    2.446404    2.291528
15 em7 [hit L2C; load L1C7]    5.848381    6.094542    4.688742    5.859470   21.799850
16 em7 [hit l1C7]              2.952381    2.093718    3.445318    2.276232    2.331253
17 em8 [hit L2C; load L1C8]    5.055647    6.017012    4.866795    7.434332   21.541394
18 em8 [hit l1C8]              2.676953    2.091851    2.427540    2.690314    2.329926
19 em9 [hit L2C; load L1C9]    5.376201    5.889659    4.757325    5.514962   21.379393
20 em9 [hit l1C9]              2.236590    2.120045    2.601815    2.524291    2.238205
----


++++
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">
  google.charts.load('current', {'packages':['corechart']});
  google.charts.setOnLoadCallback(drawChart);

  function drawChart() {
    var data = google.visualization.arrayToDataTable([
        ['  ', 'Eclipselink', 'Infinispan', 'Hazelcast',   'EhCache',  'Caffeine'],
        ['01',     13.497332,    29.761332,   24.369891,   38.078855,   92.809277],
        ['02',      4.771606,     6.313264,    4.157640,    5.565752,   21.008394],
        ['03',      2.323158,     2.200776,    3.553077,    2.585426,    2.184439],
        ['04',      6.227024,     6.111950,    4.439370,    5.670020,   20.558323],
        ['05',     14.425914,    31.792107,   32.865633,   33.439345,   45.840621],
        ['06',      2.332670,     2.192553,    2.404821,    3.302681,    2.905474],
        ['07',      5.230997,    35.114809,    4.375070,    6.058060,   21.395879],
        ['08',      2.082420,     2.397730,    2.179949,    2.747790,    2.380451],
        ['09',      4.802970,     6.020772,    4.635258,    6.546988,   21.036647],
        ['10',      2.987462,     2.116523,    2.348548,    2.384092,    2.735662],
        ['11',      5.334021,     5.985727,    4.302260,    5.872530,   20.195900],
        ['12',      2.511636,     2.086152,    2.158952,    2.938011,    2.405727],
        ['13',      5.015225,     6.082465,    6.193973,    5.853196,   20.722064],
        ['14',      3.406396,     2.110163,    2.673234,    2.446404,    2.291528],
        ['15',      5.848381,     6.094542,    4.688742,    5.859470,   21.799850],
        ['16',      2.952381,     2.093718,    3.445318,    2.276232,    2.331253],
        ['17',      5.055647,     6.017012,    4.866795,    7.434332,   21.541394],
        ['18',      2.676953,     2.091851,    2.427540,    2.690314,    2.329926],
        ['19',      5.376201,     5.889659,    4.757325,    5.514962,   21.379393],
        ['20',      2.236590,     2.120045,    2.601815,    2.524291,    2.238205],
    ]);

    var options = {
      title: 'Cache Access',
      legend: { position: 'bottom' },
      series: [
        {color: 'purple'},
        {color: 'red'},
        {color: 'blue'},
        {color: 'orange'},
        {color: 'green'},
      ]
    };

    var chart = new google.visualization.LineChart(document.getElementById('cache_chart'));

    chart.draw(data, options);
  }
</script>
<div id="cache_chart" style="width: 1024px; height: 800px"></div>
++++

Environment settings for these results

[source]
----
------------------------------------------------------------
Gradle 4.1
------------------------------------------------------------

Build time:   2017-08-07 14:38:48 UTC
Revision:     941559e020f6c357ebb08d5c67acdb858a3defc2

Groovy:       2.4.11
Ant:          Apache Ant(TM) version 1.9.6 compiled on June 29 2015
JVM:          1.8.0_144 (Oracle Corporation 25.144-b01)
OS:           Mac OS X 10.12.5 x86_64
----

== License

All code found in this repository is licensed under GPL v3

[source]
----
Copyright 2016-2017 Andres Almiray

This file is part of Java Trove Examples

Java Trove Examples is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

Java Trove Examples is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with Java Trove Examples. If not, see <http://www.gnu.org/licenses/>.
----